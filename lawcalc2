
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ontario Purchase Calculator – Minimal</title>
  <style>
    :root{--border:#e5e7eb;--brand:#2563eb;--muted:#6b7280}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;background:#f6f7fb;color:#111}
    .wrap{max-width:720px;margin:24px auto;padding:16px;background:#fff;border:1px solid var(--border);border-radius:10px}
    label{display:block;margin-bottom:6px;font-size:12px;color:var(--muted);font-weight:600}
    input[type=number]{width:100%;padding:12px;border:1px solid var(--border);border-radius:8px;font-size:16px;background:#fff;position:relative;z-index:1;pointer-events:auto}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    .card{margin-top:18px;border:1px solid var(--border);border-radius:8px}
    .card h2{margin:0;padding:10px 12px;border-bottom:1px solid var(--border);font-size:16px}
    .content{padding:12px}
    table{width:100%;border-collapse:collapse}
    td{padding:8px;border-bottom:1px solid var(--border)}
    .amount{text-align:right;white-space:nowrap}
    .total{font-weight:800}
    .btn{margin-top:12px;background:var(--brand);color:#fff;border:none;border-radius:8px;padding:10px 14px;font-weight:700;cursor:pointer}
    /* Safety: if some global style set pointer-events:none on containers, force inputs clickable */
    .wrap, .content, .row { pointer-events:auto }
  </style>
</head>
<body>
  <div class="wrap">
    <h1 style="margin:0 0 12px;font-size:20px">Ontario Purchase Calculator – Minimal</h1>

    <label for="price">Purchase Price ($)</label>
    <input id="price" type="number" min="0" step="1000" value="650000" inputmode="numeric">

    <div class="row">
      <label style="display:flex;align-items:center;gap:8px">
        <input id="isFthb" type="checkbox" checked> First‑Time Home Buyer
      </label>
      <label style="display:flex;align-items:center;gap:8px">
        <input id="isToronto" type="checkbox"> City of Toronto (MLTT)
      </label>
    </div>

    <button class="btn" id="recalc">Recalculate</button>

    <div class="card">
      <h2>Totals</h2>
      <div class="content">
        <table>
          <tr><td>Ontario LTT</td><td class="amount" id="lttDisp">$0</td></tr>
          <tr id="mlttRow" style="display:none"><td>Toronto MLTT</td><td class="amount" id="mlttDisp">$0</td></tr>
          <tr><td class="total">Estimated Total (LTT + MLTT)</td><td class="amount total" id="totalDisp">$0</td></tr>
        </table>
      </div>
    </div>
  </div>

  <script>
    function ontarioLTT(price){
      let tax=0, bands=[
        {limit:55000, rate:.005},
        {limit:250000, rate:.01},
        {limit:400000, rate:.015},
        {limit:2000000, rate:.02},
        {limit:Infinity, rate:.025},
      ], prev=0;
      for(const b of bands){
        const amt=Math.max(0, Math.min(price,b.limit)-prev);
        if(amt<=0) break;
        tax += amt*b.rate;
        prev = b.limit;
      }
      return tax;
    }
    const torontoMLTT = (p)=> ontarioLTT(p);
    function fthbRebateOntario(price, isFthb){
      // Minimal: assume citizen/PR; if needed, add the second checkbox
      if(!isFthb) return 0;
      return Math.min(4000, ontarioLTT(price));
    }
    const fmt = (n)=> n.toLocaleString('en-CA',{style:'currency',currency:'CAD',maximumFractionDigits:0});

    function recalc(){
      const price = Number(document.getElementById('price').value || 0);
      const isFthb = document.getElementById('isFthb').checked;
      const isToronto = document.getElementById('isToronto').checked;

      let ltt = Math.max(0, ontarioLTT(price) - fthbRebateOntario(price, isFthb));
      let mltt = isToronto ? torontoMLTT(price) : 0;

      document.getElementById('lttDisp').textContent = fmt(ltt);
      document.getElementById('mlttDisp').textContent = fmt(mltt);
      document.getElementById('mlttRow').style.display = isToronto ? '' : 'none';
      document.getElementById('totalDisp').textContent = fmt(ltt + mltt);
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      document.getElementById('recalc').addEventListener('click', recalc);
      ['price','isFthb','isToronto'].forEach(id=>{
        const el=document.getElementById(id);
        el.addEventListener('input', recalc);
        el.addEventListener('change', recalc);
      });
      recalc();
    });
  </script>
</body>
</html>
